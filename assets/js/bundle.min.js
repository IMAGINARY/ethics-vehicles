!function o(a,s,u){function c(t,e){if(!s[t]){if(!a[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(l)return l(t,!0);var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var r=s[t]={exports:{}};a[t][0].call(r.exports,function(e){return c(a[t][1][e]||e)},r,r.exports,o,a,s,u)}return s[t].exports}for(var l="function"==typeof require&&require,e=0;e<u.length;e++)c(u[e]);return c}({1:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object.defineProperty(n,"__esModule",{value:!0}),n.Sounds=n.default=void 0;var i=function(){function i(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.media=t.map(function(e){return new Audio(e)})}var e,t,n;return e=i,(t=[{key:"getAudio",value:function(){var e=Math.floor(Math.random()*Math.floor(this.media.length));return this.media[e]}},{key:"play",value:function(){this.getAudio().play()}}])&&r(e.prototype,t),n&&r(e,n),i}(),o={crash500ms:new(n.default=i)("assets/audio/crash_500ms.mp3"),crash250ms:new i("assets/audio/crash_250ms.mp3"),carIdling2000ms:new i("assets/audio/passing_by_1_2000ms.mp3","assets/audio/passing_by_2_2000ms.mp3","assets/audio/passing_by_3_2000ms.mp3")};n.Sounds=o,Object.freeze(o)},{}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("./constants"),o=e("./pixi-help"),a=e("./lane");function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var i=function(){function i(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:a.NO_LANE;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this.view=e,this.sprite=(0,o.createSprite)(t,r.CAR_SCALE,.5),this.sprite.zIndex=100,this.lane=n}var e,t,n;return e=i,(t=[{key:"placeInLane",value:function(e,t,n){var i=1<arguments.length&&void 0!==t?t:0,r=!(2<arguments.length&&void 0!==n)||n;this.lane=e,this.x=e.start.x+(e.end.x-e.start.x)*i,this.y=e.start.y+(e.end.y-e.start.y)*i,r&&this.forceLaneDirection()}},{key:"forceLaneDirection",value:function(){this.sprite.angle=this.lane.getDrivingAngle()}},{key:"driveInLaneUntilPosition",value:function(e,t,n){var i=this,r=0<arguments.length&&void 0!==e?e:1,o=1<arguments.length&&void 0!==t?t:500,a=2<arguments.length&&void 0!==n?n:TWEEN.Easing.Linear.None,s=this.lane.getPositionCoordinates(r);return new Promise(function(e){new TWEEN.Tween(i.sprite).to({x:s.x,y:s.y},o).easing(a).onComplete(function(){return e("arrived")}).start()})}},{key:"advanceAndTurn",value:function(t,e,n,i){var r=this,o=1<arguments.length&&void 0!==e?e:0,a=2<arguments.length&&void 0!==n?n:1e3,s=3<arguments.length&&void 0!==i?i:TWEEN.Easing.Linear.None;return new Promise(function(e){new TWEEN.Tween(r).to({x:r.x+t.x,y:r.y+t.y,angle:r.angle+o},a).easing(s).onComplete(function(){return e("crash")}).start()})}},{key:"crossLane",value:function(){this.placeInLane(this.lane.oppositeLane,1-this.lane.getCarPosition(this),!1)}},{key:"show",value:function(){this.view.container.addChild(this.sprite)}},{key:"hide",value:function(){this.view.container.removeChild(this.sprite)}},{key:"x",get:function(){return this.sprite.x},set:function(e){this.sprite.x=e}},{key:"y",get:function(){return this.sprite.y},set:function(e){this.sprite.y=e}},{key:"angle",get:function(){return this.sprite.angle},set:function(e){this.sprite.angle=e}}])&&s(e.prototype,t),n&&s(e,n),i}();n.default=i},{"./constants":3,"./lane":5,"./pixi-help":9}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SPRITE_WIDTH=n.STREET_LANE_OFFSET=n.BLOCK_SIZE=n.STREET_WIDTH=n.IDLE_ANIMATION_TIME=n.DEFAULT_SPEED=n.BorderBlockSize=n.StreetOffsetFromCenter=n.ViewSize=n.CAR_SCALE=void 0;n.CAR_SCALE=.25;n.ViewSize={width:1920,height:1080};n.StreetOffsetFromCenter={x:560,y:350};n.BorderBlockSize={width:320,height:110};n.DEFAULT_SPEED=15;n.IDLE_ANIMATION_TIME=2e3;n.STREET_WIDTH=160;n.BLOCK_SIZE=512;n.STREET_LANE_OFFSET=40;n.SPRITE_WIDTH=64},{}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("./style-help");function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var i=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.htmlElement=e,this.infoElements=Array.from($(".info_element"))}var e,n,i;return e=t,(n=[{key:"show",value:function(e,t){var n=this.infoElements[e];n.querySelector("#name").innerText=t.name,n.querySelector("#description").innerHTML=t.description,n.style.visibility="visible"}},{key:"fadeShow",value:function(e,t,n){this.show(e,t);var i=this.infoElements[e];return(i.style.opacity=0,r.tweenOpacity)(i,.75,n)}},{key:"hide",value:function(e){this.infoElements[e].style.visibility="hidden"}},{key:"hideAll",value:function(){var n=this;this.infoElements.forEach(function(e,t){return n.hide(t)})}}])&&o(e.prototype,n),i&&o(e,i),t}();n.default=i},{"./style-help":18}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.NO_LANE=n.Lane=void 0;var r=e("./pixi-help");function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}PIXI.Point.Lerp=function(e,t,n){return new PIXI.Point(e.x+n*(t.x-e.x),e.y+n*(t.y-e.y))};var i=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.start=e,this.end=t,this.oppositeLane=null}var e,t,i;return e=n,(t=[{key:"isVertical",value:function(){return this.start.x==this.end.x}},{key:"isHorizontal",value:function(){return this.start.y==this.end.y}},{key:"getDrivingAngle",value:function(){return(0,r.vectorBetweenPoints)(this.start,this.end)}},{key:"getPositionCoordinates",value:function(e){return PIXI.Point.Lerp(this.start,this.end,e)}},{key:"getCarPosition",value:function(e){return this.isVertical()?(e.y-this.start.y)/(this.end.y-this.start.y):(e.x-this.start.x)/(this.end.x-this.start.x)}}])&&o(e.prototype,t),i&&o(e,i),n}(),a=new(n.Lane=i)(r.POINT_ZERO,new PIXI.Point(1,0));n.NO_LANE=a},{"./pixi-help":9}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LANES=void 0;var i=e("./lane"),r=e("./constants");function o(e,t){return new i.Lane(new PIXI.Point(r.ViewSize.width/2*t,-e),new PIXI.Point(-r.ViewSize.width/2*t,-e))}function a(e,t){return new i.Lane(new PIXI.Point(-e,r.ViewSize.height/2*t),new PIXI.Point(-e,-r.ViewSize.height/2*t))}var s=[a(r.StreetOffsetFromCenter.x-r.STREET_LANE_OFFSET,1),a(r.StreetOffsetFromCenter.x+r.STREET_LANE_OFFSET,-1),a(-r.StreetOffsetFromCenter.x-r.STREET_LANE_OFFSET,1),a(-r.StreetOffsetFromCenter.x+r.STREET_LANE_OFFSET,-1),o(r.StreetOffsetFromCenter.y+r.STREET_LANE_OFFSET,1),o(r.StreetOffsetFromCenter.y-r.STREET_LANE_OFFSET,-1),o(-r.StreetOffsetFromCenter.y+r.STREET_LANE_OFFSET,1),o(-r.StreetOffsetFromCenter.y-r.STREET_LANE_OFFSET,-1)];function u(e,t){(e.oppositeLane=t).oppositeLane=e}u((n.LANES=s)[0],s[1]),u(s[2],s[3]),u(s[4],s[5]),u(s[6],s[7])},{"./constants":3,"./lane":5}],7:[function(e,t,n){"use strict";var i,r=(i=e("./view"))&&i.__esModule?i:{default:i};e("./situations/car-enters-lane"),e("./situations/tree-falls"),e("./situations/child-runs"),new r.default($("#game")[0]).start()},{"./situations/car-enters-lane":15,"./situations/child-runs":16,"./situations/tree-falls":17,"./view":19}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("./style-help");function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var i=function(){function i(e,t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this.currentOption=0,this.visible=!1,this.options=Array.from(t),this.titleText=n,this.htmlElement=$("#".concat(e)),this.optionsArea=this.htmlElement.find("#menu_options_area"),this.cursor=this.htmlElement.find("#menu_cursor"),this.title=this.htmlElement.find("#menu_title")}var e,t,n;return e=i,(t=[{key:"show",value:function(){var t=this;this.createHTMLOptions(),this.currentOption=0,this.title.text(this.titleText),window.onkeydown=function(e){switch(e.which){case 38:t.up();break;case 40:t.down();break;case 13:t.enterOption()}},this.updateCursorPosition(),this.htmlElement.show(),this.fadeInCursor()}},{key:"hide",value:function(){this.htmlElement.hide(),window.onkeydown=function(){},this.clearHTML()}},{key:"fadeInCursor",value:function(){var e=this.cursor[0];return(e.style.opacity=0,r.tweenOpacity)(e,1,500).then(function(){return(0,r.tweenOpacity)(e,.125,500)}).then(function(){return(0,r.tweenOpacity)(e,1,500)})}},{key:"createHTMLOptions",value:function(){this.options.forEach(function(e){var t=$('<input type="button" value="'.concat(e.text,'" class="menu_option">'));$("#menu_options_area").append(t),t.click(e.action)})}},{key:"clearHTML",value:function(){this.optionsArea.empty()}},{key:"enterOption",value:function(){var e=this.options[this.currentOption].action;this.hide(),e()}},{key:"down",value:function(){this.currentOption<this.options.length-1&&this.currentOption++,this.updateCursorPosition()}},{key:"up",value:function(){0<this.currentOption&&this.currentOption--,this.updateCursorPosition()}},{key:"updateCursorPosition",value:function(){this.cursor.css("margin-top",15+75*this.currentOption+"px")}}])&&o(e.prototype,t),n&&o(e,n),i}();n.default=i},{"./style-help":18}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.createSprite=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:.5,i=PIXI.Texture.from(e),r=new PIXI.Sprite(i);return r.scale.x=t,r.scale.y=t,r.anchor.set(n),r},n.highlightSprite=function(e,t){var n=new PIXI.Graphics;return n.beginFill(t,.5),n.drawRect(e.x-e.width/2,e.y-e.height/2,e.width,e.height),n.endFill(),n},n.vectorBetweenPoints=function(e,t){var n=new PIXI.Point(0,-1),i=new PIXI.Point(t.x-e.x,t.y-e.y);return 180*(Math.atan2(i.y,i.x)-Math.atan2(n.y,n.x))/Math.PI},n.screenPosFromFraction=r,n.moveToFraction=function(e,t,n){var i=r(t,n);e.x=i.x,e.y=i.y},n.pixiFadeIn=function(t,n){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1e3;return new Promise(function(e){new TWEEN.Tween(t).to({alpha:n},i).easing(TWEEN.Easing.Quadratic.Out).onComplete(function(){return e("visible")}).start()})},n.pixiMoveTo=function(t,n){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1e3;return new Promise(function(e){new TWEEN.Tween(t).to({x:n.x,y:n.y},i).easing(TWEEN.Easing.Linear.None).onComplete(function(){return e("moved")}).start()})},n.POINT_ZERO=void 0;var i=e("./constants");function r(e,t){return new PIXI.Point((e-.5)*i.ViewSize.width,(t-.5)*i.ViewSize.height)}var o=new PIXI.Point(0,0);n.POINT_ZERO=o},{"./constants":3}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Policies=void 0;n.Policies=[{id:"humanist",name:"Humanist",objective:"Minimize human injuries"},{id:"profit",name:"Profit-based",objective:"Minimize insurance costs"},{id:"protector",name:"Protector",objective:"Protect car passengers"}]},{}],11:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.htmlElement=e,this.decisionElement=this.htmlElement.querySelector("#decision"),this.policyNameElement=this.htmlElement.querySelector("#policy_name"),this.policyObjectiveElement=this.htmlElement.querySelector("#policy_objective"),this.situationDescriptionElement=this.htmlElement.querySelector("#situation_description")}var e,n,i;return e=t,(n=[{key:"show",value:function(e,t,n){this.decisionElement.innerHTML=n,this.policyNameElement.innerHTML=t.name,this.policyObjectiveElement.innerHTML=t.objective,this.situationDescriptionElement.innerHTML=e.getDescription(),this.htmlElement.style.visibility="visible"}},{key:"hide",value:function(){this.htmlElement.style.visibility="hidden"}}])&&r(e.prototype,n),i&&r(e,i),t}();n.default=i},{}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=e("./pixi-help"),a=e("./constants");function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var r=function(){function r(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:o.POINT_ZERO,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:a.CAR_SCALE;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.view=e,this.sprite=(0,o.createSprite)(t,i),this.sprite.x=n.x,this.sprite.y=n.y,this.initialPosition=n,this.visible=!1}var e,t,n;return e=r,(t=[{key:"fadeIn",value:function(e){return this.show(),(this.sprite.alpha=0,o.pixiFadeIn)(this.sprite,1,e)}},{key:"show",value:function(){var t=this;return new Promise(function(e){t.view.container.addChild(t.sprite),t.visible=!0,e()})}},{key:"hide",value:function(){var t=this;return new Promise(function(e){t.view.container.removeChild(t.sprite),t.visible=!1,e()})}},{key:"reset",value:function(){this.sprite.x=this.initialPosition.x,this.sprite.y=this.initialPosition.y,this.sprite.angle=0}}])&&i(e.prototype,t),n&&i(e,n),r}();n.default=r},{"./constants":3,"./pixi-help":9}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i,r=e("./policies"),o=e("./pixi-help"),a=(i=e("./menu"))&&i.__esModule?i:{default:i};function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var u=function(){function i(e,t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this.view=e,this.report=t,this.infoBoxes=n,this.currentDecision=null,this.tempElements=[],this.currentPolicy=null,this.policyMenu=null}var e,t,n;return e=i,(t=[{key:"run",value:function(e){var t=this;this.view.agentCar.hide(),e.setup().then(function(){return e.start()}).then(function(){return e.wait(1e3)}).then(function(){return t.showElementsInfo(e.getElements())}).then(function(){return t.waitForPolicy(e)}).then(function(){return t.hideElementsInfo()}).then(function(){return t.showDecision(e)}).then(function(){return e.wait(1e3)}).then(function(){return t.waitForAdvanceButton("Show")}).then(function(){return t.hideDecision()}).then(function(){return t.playOutDecision()}).then(function(){return e.wait(1e3)}).then(function(){return t.waitForAdvanceButton("Restart")}).then(function(){return e.clearSprites()}).then(function(){return e.teardown()}).then(function(){return t.view.start()})}},{key:"waitForPolicy",value:function(n){var i=this;return new Promise(function(t){var e=r.Policies.map(function(e){return{text:e.name+": "+e.objective,action:function(){i.currentPolicy=e,i.currentDecision=n.getDecision(e.id),i.policyMenu.hide(),t(e.name)}}});i.policyMenu=new a.default("menu",e,"Choose a policy"),i.policyMenu.show()})}},{key:"waitForAdvanceButton",value:function(e){var n=0<arguments.length&&void 0!==e?e:"Next";return new Promise(function(e){$("#advanceText").text(n);var t=$("#advanceButton");t.show(),t.on("click",function(){t.hide(),e("clicked")})})}},{key:"waitForKeyPress",value:function(){return new Promise(function(e){window.onkeydown=function(){window.onkeydown=function(){},e("keydown")}})}},{key:"showElementsInfo",value:function(e){var i=this,r=new Promise(function(e){return e("start fades")});return e.forEach(function(t,n){r=r.then(function(e){return i.highlight(t.sprite,t.color),i.infoBoxes.fadeShow(n,t,1e3)})}),r}},{key:"hideElementsInfo",value:function(){var t=this;return new Promise(function(e){t.removeTempElements(),t.infoBoxes.hideAll(),e("clean")})}},{key:"showDecision",value:function(e){return this.report.show(e,this.currentPolicy,this.currentDecision.text)}},{key:"hideDecision",value:function(){return this.report.hide()}},{key:"playOutDecision",value:function(){return this.currentDecision.actionFunction()}},{key:"highlight",value:function(e,t){this.addTempElement((0,o.highlightSprite)(e,t))}},{key:"addTempElement",value:function(e){this.tempElements.push(e),this.view.container.addChild(e)}},{key:"removeTempElements",value:function(){var t=this;this.tempElements.forEach(function(e){t.view.container.removeChild(e)}),this.tempElements=[]}}])&&s(e.prototype,t),n&&s(e,n),i}();n.default=u},{"./menu":8,"./pixi-help":9,"./policies":10}],14:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=function(){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.view=e,this.sprites=[]}var e,t,i;return e=n,i=[{key:"registerSituation",value:function(e,t){n.situations[e]=t}},{key:"getSituation",value:function(e,t){return new n.situations[e](t)}}],(t=[{key:"addSprite",value:function(e){this.sprites.push(e),this.view.container.addChild(e)}},{key:"clearSprites",value:function(){var t=this;this.sprites.forEach(function(e){t.view.container.removeChild(e)})}},{key:"setup",value:function(){}},{key:"start",value:function(){}},{key:"teardown",value:function(){}},{key:"getElements",value:function(){}},{key:"getDecisions",value:function(){}},{key:"getDescription",value:function(){}},{key:"getDecision",value:function(e){return this.getDecisions()[e]}},{key:"wait",value:function(e){var t=0<arguments.length&&void 0!==e?e:1e3;return new Promise(function(e){return setTimeout(e,t)})}}])&&r(e.prototype,t),i&&r(e,i),n}();(n.default=i).situations={}},{}],15:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("../constants"),o=i(e("../scene-element")),a=i(e("../situation")),s=e("../audio"),u=i(e("../car")),c=e("../lanes");function i(e){return e&&e.__esModule?e:{default:e}}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function f(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var v=r.ViewSize.width/2-r.BorderBlockSize.width+r.SPRITE_WIDTH/2,y=-.06*r.ViewSize.height,w=new PIXI.Point(r.STREET_LANE_OFFSET,r.STREET_LANE_OFFSET),m=new PIXI.Point(0,40),g=new PIXI.Point(0,-40),E=new PIXI.Point(1.5*-r.STREET_LANE_OFFSET,1.5*-r.STREET_LANE_OFFSET),b=new PIXI.Point(1.5*r.STREET_LANE_OFFSET,1.5*-r.STREET_LANE_OFFSET),T=function(){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=f(this,d(n).call(this,e))).agentLane=c.LANES[2],t.parkedLane=t.agentLane.oppositeLane,t.blackCar=new u.default(e,"assets/images/car_black.png"),t.truck=new u.default(e,"assets/images/small_truck.png"),t.busStop=new o.default(e,"assets/images/bus_stop.png",new PIXI.Point(v,y)),t}var e,t,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(n,a["default"]),e=n,(t=[{key:"setup",value:function(){return this.busStop.fadeIn(500)}},{key:"teardown",value:function(){this.busStop.hide()}},{key:"start",value:function(){var e=this;return this.view.agentCar.hide(),this.moveTruckInPosition().then(function(){return Promise.all([e.moveBlackCarInPosition(),e.moveAgentInPosition()])})}},{key:"getElements",value:function(){return[{sprite:this.view.agentCar.sprite,color:3285214,name:"Autonomous car",description:"Property value: medium"},{sprite:this.blackCar.sprite,color:14561824,name:"Luxury car",description:"Suddenly enters your lane.<br>Property Value: high<br>Insurance: yes"},{sprite:this.truck.sprite,color:14561824,name:"Parked car",description:"Passengers: 4<br>Property value: low<br>Insurance: none"},{sprite:this.busStop.sprite,color:14561824,name:"Bus Stop",description:"People: 10<br>Property value: medium"}]}},{key:"getDecisions",value:function(){var e=this;return{humanist:{text:"Turning left will risk 4 lives. Turning right with certainly kill people at the stop. Solution: breaking and crashing into the car in front will probably not result in fatalities, so itâ€™s the action taken",actionFunction:function(){return e.decisionAdvace()}},profit:{text:"the car ahead is very expensive, so breaking is not recommended. Turning right will risk high payouts to the victims or their families. Solution: turn left towards the parked car, as it is cheap and if the risk of casualties is lower.",actionFunction:function(){return e.decisionTurnLeft()}},protector:{text:"breaking and turning left mean crashing into heavy, hard objects and potentially harming you. Solution: turning right has almost no risk for you and your car, as people are softer than cars.",actionFunction:function(){return e.decisionTurnRight()}}}}},{key:"getDescription",value:function(){return"A car enters your lane and there is no time to break. The car can either crash against it, turn left and crash against a parked car, or turn right and drive over a bus stop full of people"}},{key:"decisionAdvace",value:function(){return s.Sounds.crash250ms.play(),Promise.all([this.blackCar.advanceAndTurn(m,0,150),this.view.agentCar.advanceAndTurn(g,0,150)])}},{key:"decisionTurnLeft",value:function(){return s.Sounds.crash250ms.play(),Promise.all([this.moveBlackCarToFinalPosition(),this.view.agentCar.advanceAndTurn(E,-30,250)])}},{key:"decisionTurnRight",value:function(){return s.Sounds.crash500ms.play(),Promise.all([this.moveBlackCarToFinalPosition(),this.view.agentCar.advanceAndTurn(b,30,250)])}},{key:"moveTruckInPosition",value:function(){return this.addSprite(this.truck.sprite),this.truck.placeInLane(this.parkedLane),this.truck.driveInLaneUntilPosition(.45,1e3,TWEEN.Easing.Cubic.Out)}},{key:"moveBlackCarInPosition",value:function(){var e=this;return this.addSprite(this.blackCar.sprite),this.blackCar.placeInLane(this.parkedLane),this.blackCar.driveInLaneUntilPosition(.35,500,TWEEN.Easing.Sinusoidal.Out).then(function(){return e.wait(500)}).then(function(){return e.blackCar.advanceAndTurn(w,-45,250,TWEEN.Easing.Quadratic.In)}).then(function(){return e.blackCar.advanceAndTurn(w,45,250,TWEEN.Easing.Quadratic.Out)})}},{key:"moveBlackCarToFinalPosition",value:function(){return this.blackCar.advanceAndTurn(new PIXI.Point(0,2*r.STREET_LANE_OFFSET),0,250,TWEEN.Easing.Linear.None)}},{key:"moveAgentInPosition",value:function(){var e=this;return this.wait(700).then(function(){e.view.agentCar.show(),e.view.agentCar.placeInLane(e.agentLane),e.view.agentCar.driveInLaneUntilPosition(.45,800)})}}])&&h(e.prototype,t),i&&h(e,i),n}();n.default=T,a.default.registerSituation("car-enters-lane",T)},{"../audio":1,"../car":2,"../constants":3,"../lanes":6,"../scene-element":12,"../situation":14}],16:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=i(e("../scene-element")),o=i(e("../car")),a=i(e("../situation")),s=e("../lanes"),u=e("../pixi-help"),c=e("../constants");function i(e){return e&&e.__esModule?e:{default:e}}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function f(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var v=(0,u.screenPosFromFraction)(.28125,1/16),y=(0,u.screenPosFromFraction)(9/32,1/8),w=function(){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=f(this,d(n).call(this,e))).agentLane=s.LANES[4],t.oppositeLane=t.agentLane.oppositeLane,t.child=new r.default(t.view,"assets/images/child.png",v),t.crossingCar=new o.default(t.view,"assets/images/blue_car.png"),t.ambulance=new o.default(t.view,"assets/images/ambulance.png"),t}var e,t,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(n,a["default"]),e=n,(t=[{key:"setup",value:function(){return this.child.show()}},{key:"start",value:function(){return Promise.all([this.moveAgentInPosition(),this.moveCrossingCarInPosition(),this.moveAmbulanceInPosition(),this.childRuns()])}},{key:"teardown",value:function(){this.child.hide()}},{key:"getElements",value:function(){return[{sprite:this.view.agentCar.sprite,color:3285214,name:"Autonomous car",description:"About to cross the intersection with green light."},{sprite:this.ambulance.sprite,color:14561824,name:"Ambulance",description:"Carrying a patient to the hospital"},{sprite:this.child.sprite,color:14561824,name:"Child",description:"Suddenly runs in the street"},{sprite:this.crossingCar.sprite,color:14561824,name:"A Car",description:"Probably will not stop"}]}},{key:"getDecisions",value:function(){var e=this;return{humanist:{text:"both breaking and continuing have a high risk on human lives, so crash onto the car parked on the left.",actionFunction:function(){return e.decisionCrashCrossingCar()}},profit:{text:"the child appeared out of nowhere and you had a green light, so you are protected by the law. Breaking or turning left will incur in higher car damage and costs.",actionFunction:function(){return e.decisionAdvance()}},protector:{text:"breaking or turning left will damage the car and potentially hurt you, continuing will only produce minor aesthetical damage in the car.",actionFunction:function(){return e.decisionAdvance()}}}}},{key:"decisionAdvance",value:function(){return this.view.agentCar.driveInLaneUntilPosition(.75,250)}},{key:"decisionCrashCrossingCar",value:function(){var t=this,e=new Promise(function(e){new TWEEN.Tween(t.view.agentCar).to({x:t.view.agentCar.x-c.STREET_LANE_OFFSET,y:t.view.agentCar.y+1.5*c.STREET_LANE_OFFSET,angle:t.view.agentCar.angle-60},250).easing(TWEEN.Easing.Quadratic.Out).onComplete(function(){return e("crash")}).start()}),n=this.crossingCar.driveInLaneUntilPosition(.3125,250);return Promise.all([e,n])}},{key:"getDescription",value:function(){return"When reaching a crossing and having a green light, a child suddenly runs onto the street from behind a parked car. At the same time, an ambulance with lights and siren is coming behind you fast."}},{key:"moveAgentInPosition",value:function(){return this.view.agentCar.show(),this.view.agentCar.placeInLane(this.agentLane),this.view.agentCar.driveInLaneUntilPosition(.625,1500)}},{key:"moveCrossingCarInPosition",value:function(){var e=this;return this.wait(1e3).then(function(){return e.addSprite(e.crossingCar.sprite),e.crossingCar.placeInLane(e.oppositeLane),e.crossingCar.driveInLaneUntilPosition(.25,500)})}},{key:"moveAmbulanceInPosition",value:function(){var e=this;return this.wait(400).then(function(){return e.addSprite(e.ambulance.sprite),e.ambulance.placeInLane(e.agentLane),e.ambulance.driveInLaneUntilPosition(.53125,1100)})}},{key:"childRuns",value:function(){var e=this;return this.wait(1e3).then(function(){return(0,u.pixiMoveTo)(e.child.sprite,y,500)})}}])&&h(e.prototype,t),i&&h(e,i),n}();n.default=w,a.default.registerSituation("child-runs",w)},{"../car":2,"../constants":3,"../lanes":6,"../pixi-help":9,"../scene-element":12,"../situation":14}],17:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=i(e("../scene-element")),o=i(e("../car")),a=i(e("../situation")),s=e("../constants"),u=e("../lanes");function i(e){return e&&e.__esModule?e:{default:e}}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function h(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=h(this,f(n).call(this,e))).waterPuddle=new r.default(t.view,"assets/images/water_puddle.png",new PIXI.Point(-s.StreetOffsetFromCenter.x-s.STREET_LANE_OFFSET,-s.STREET_LANE_OFFSET)),t.tree=new r.default(t.view,"assets/images/tree.png",new PIXI.Point(-s.StreetOffsetFromCenter.x-3*s.STREET_LANE_OFFSET,0)),t.cyclist=new o.default(t.view,"assets/images/cyclist.png"),t.agentLane=u.LANES[1],t.bicycleLane=t.agentLane.oppositeLane,t}var e,t,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(n,a["default"]),e=n,(t=[{key:"setup",value:function(){var e=this;return this.tree.reset(),this.waterPuddle.reset(),this.tree.fadeIn(250).then(function(){return e.waterPuddle.fadeIn(250)})}},{key:"start",value:function(){return Promise.all([this.moveAgentInPosition(),this.moveCyclistInPosition(),this.fellTree()])}},{key:"teardown",value:function(){this.tree.hide(),this.waterPuddle.hide(),this.cyclist.hide()}},{key:"getElements",value:function(){return[{sprite:this.view.agentCar.sprite,color:3285214,name:"Autonomous car",description:"Property value: medium<br><b>Warning! Front passenger not wearing seat belt.</b>"},{sprite:this.cyclist.sprite,color:14561824,name:"Cyclist",description:"Insurance: unknown"},{sprite:this.tree.sprite,color:14561824,name:"Fallen Tree",description:"Hard. Try not to crash unto it."}]}},{key:"getDecisions",value:function(){var e=this;return{humanist:{text:"a sudden break would send the passenger without seatbelt forward through the glass, potentially killing them. Swerving might avoid the collision with the tree, but could also harm the passenger. Solution: turn right and break, crashing into the tree softly, with the passenger without seatbelt protected by the one on its side and by its airbag.",actionFunction:function(){return e.softlyCrashTree()}},profit:{text:"Crashing with the tree will cost the insurers money. Swerving might avoid the collision with the tree, but as the floor is wet it could also potentially turn around the car, damaging it. As the car has warned the passenger to wear the seat belt but they have not, any injury will be their own responsibility. Changing lanes would kill the cyclist, but its insurance status is unknown, so its a financial risk. Solution: a sudden break, fully protecting the car and passengers that wear a seat belt.",actionFunction:function(){return e.fullBreak()}},protector:{text:"Crashing with the tree or swerving would hurt the passenger without seatbelt. Solution: slow down and change lanes, potentially killing the cyclist but saving all passengers.",actionFunction:function(){return e.crashCyclist()}}}}},{key:"getDescription",value:function(){return"a tree falls in front of the car. The person in the front passenger seat has no seat belt. A cyclist is riding through the opposite lane. Options: Sudden break, slow down and turn left, slow down and turn right."}},{key:"moveCyclistInPosition",value:function(){return this.cyclist.show(),this.cyclist.placeInLane(this.bicycleLane),this.cyclist.driveInLaneUntilPosition(3/8,1e3)}},{key:"moveAgentInPosition",value:function(){return this.view.agentCar.show(),this.view.agentCar.placeInLane(this.agentLane),this.view.agentCar.driveInLaneUntilPosition(3/8,1e3)}},{key:"fellTree",value:function(){var t=this;return new Promise(function(e){new TWEEN.Tween(t.tree.sprite).to({angle:90,x:t.tree.sprite.x+1.5*s.STREET_LANE_OFFSET},750).easing(TWEEN.Easing.Quadratic.In).delay(250).onComplete(function(){return e("fell")}).start()})}},{key:"crashCyclist",value:function(){var t=this,e=new Promise(function(e){new TWEEN.Tween(t.view.agentCar).to({x:t.view.agentCar.x+2*s.STREET_LANE_OFFSET,y:t.view.agentCar.y+2*s.STREET_LANE_OFFSET,angle:t.view.agentCar.angle-45},250).easing(TWEEN.Easing.Quadratic.Out).onComplete(function(){return e("crash")}).start()}),n=this.cyclist.driveInLaneUntilPosition(.5,250);return Promise.all([e,n])}},{key:"fullBreak",value:function(){return this.view.agentCar.driveInLaneUntilPosition(7/16,250)}},{key:"softlyCrashTree",value:function(){var t=this;return new Promise(function(e){new TWEEN.Tween(t.view.agentCar).to({x:t.view.agentCar.x-s.STREET_LANE_OFFSET,y:t.view.agentCar.y+2*s.STREET_LANE_OFFSET,angle:t.view.agentCar.angle+70},250).easing(TWEEN.Easing.Quadratic.Out).onComplete(function(){return e("crash")}).start()})}}])&&l(e.prototype,t),i&&l(e,i),n}();n.default=p,a.default.registerSituation("tree-falls",p)},{"../car":2,"../constants":3,"../lanes":6,"../scene-element":12,"../situation":14}],18:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.tweenOpacity=function(t,n){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1e3;return new Promise(function(e){new TWEEN.Tween(t.style).to({opacity:n},i).easing(TWEEN.Easing.Quadratic.Out).onComplete(function(){return e("visible")}).start()})}},{}],19:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=i(e("./car")),o=i(e("./scene-element")),a=e("./lanes"),s=e("./constants"),u=e("./pixi-help"),c=e("./audio"),l=i(e("./report")),h=i(e("./info-boxes")),f=i(e("./situation")),d=i(e("./situation-runner")),p=i(e("./menu.js"));function i(e){return e&&e.__esModule?e:{default:e}}function v(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var y=function(){function n(e){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.app=new PIXI.Application({width:s.ViewSize.width,height:s.ViewSize.height,backgroundColor:0,resolution:window.devicePixelRatio||1}),e.appendChild(this.app.view),this.container=new PIXI.Container,this.container.sortableChildren=!0,this.app.stage.addChild(this.container),this.container.x=this.app.screen.width/2,this.container.y=this.app.screen.height/2,this.background=new o.default(this,"assets/images/street.png",u.POINT_ZERO,1),this.debugLayer=new o.default(this,"assets/images/debug.png",u.POINT_ZERO,1),this.agentCar=new r.default(this,"assets/images/car.png"),this.background.show(),this.debugLayer.hide(),this.afterIdleAction=function(){},this.SituationMenu=new p.default("menu",[{text:"A tree falls",action:function(){return t.startSituation("tree-falls")}},{text:"A car enters your lane",action:function(){return t.startSituation("car-enters-lane")}},{text:"A child runs in the street",action:function(){return t.startSituation("child-runs")}}],"Choose a scenario"),this.runner=new d.default(this,new l.default($("#report")[0]),new h.default($("#info_elements")[0])),this.app.ticker.add(function(){return TWEEN.update()})}var e,t,i;return e=n,(t=[{key:"doIdleAnimation",value:function(){var e=a.LANES[Math.floor(Math.random()*a.LANES.length)];return this.agentCar.hide(),this.agentCar.show(),this.agentCar.placeInLane(e,0,!0),c.Sounds.carIdling2000ms.play(),this.agentCar.driveInLaneUntilPosition(1,s.IDLE_ANIMATION_TIME)}},{key:"startIdleAnimation",value:function(){var e=this;this.afterIdleAction=this.startIdleAnimation,this.doIdleAnimation().then(function(){return e.afterIdleAction()})}},{key:"start",value:function(){this.SituationMenu.show(),this.startIdleAnimation()}},{key:"startSituation",value:function(t){var n=this;this.SituationMenu.hide(),this.queueAction(function(){var e=f.default.getSituation(t,n);n.runner.run(e)})}},{key:"queueAction",value:function(e){this.afterIdleAction=e}}])&&v(e.prototype,t),i&&v(e,i),n}();n.default=y},{"./audio":1,"./car":2,"./constants":3,"./info-boxes":4,"./lanes":6,"./menu.js":8,"./pixi-help":9,"./report":11,"./scene-element":12,"./situation":14,"./situation-runner":13}]},{},[7]);
//# sourceMappingURL=bundle.min.js.map
